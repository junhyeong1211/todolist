const form = document.querySelector('form');
const input = document.querySelector('input');
const ul = document.querySelector('ul');

form.addEventListener('submit', (event) => {
  event.preventDefault();

  if (input.value !== '') {
    const li = document.createElement('li');
    const delBtn = document.createElement('button');
    li.innerText = input.value; 

    const btn = document.createElement('button');
    btn.innerHTML = 'â˜‘ï¸'; // Use the checkbox symbol
    
    btn.addEventListener('click', () => {
      li.classList.toggle('completed'); // Toggle 'completed' class on the li element
    });

    li.insertBefore(btn, li.firstChild);

    const emoji = "ğŸ—‘ï¸";
    const span = document.createElement('span');
    span.innerText = emoji;
    delBtn.innerHTML = "";
    delBtn.appendChild(span);
    li.appendChild(delBtn);
    ul.appendChild(li);

    input.value = '';

    delBtn.addEventListener('click', () => {
      li.remove();
      reindex();
    });
  }
});

const clearBtn = document.createElement('button');
clearBtn.innerText = 'Clear All';
clearBtn.classList.add('clear-button');

clearBtn.addEventListener('click', () => {
  while (ul.firstChild) {
    ul.removeChild(ul.firstChild);
  }
});
const container = document.querySelector('.container');
container.appendChild(clearBtn);

function reindex() {
  const lis = ul.querySelectorAll('li'); //ul ìš”ì†Œ ë‚´ì˜ li ì„ íƒ

  lis.forEach((li) => {

    const existingDelBtn = li.querySelector('button');
    if (!existingDelBtn) { //ë²„íŠ¼ ì¡´ì¬ì•ŠëŠ”ë‹¤ë©´...
      const delBtn = document.createElement('button'); //ë²„íŠ¼ ë§Œë“¦
      delBtn.addEventListener('click', (event) => {
        event.stopPropagation(); //ë§¤ì„œë“œ í˜¸ì¶œ, ë¶€ëª¨ë¡œ ì „ë‹¬ ë°©ì§€
        li.remove();
        reindex();
      });

      li.appendChild(delBtn); //ìƒì„±í•œ delë²„íŠ¼ liìš”ì†Œì— ì¶”ê°€
    }
    
  });
}
